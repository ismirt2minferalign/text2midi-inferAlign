<h1 align="center">ðŸŽ¼ Text2midi-InferAlign</h1>
<p align="center"><b>Improving Symbolic Music Generation with Inference-Time Alignment</b></p>

<p align="center">
  ðŸ‘‰ <a href="https://ismirt2minferalign.github.io/text2midi-inferAlign/">Examples</a> ðŸ‘ˆ
</p>

---

**Text2midi-InferAlign** is a novel inference-time technique designed to enhance symbolic music generation by improving alignment between generated compositions and textual prompts. Built to extend existing autoregressive models without additional training or fine-tuning, our method adds two lightweight yet powerful objectives during generation:

- **ðŸŽµ Text-Audio Consistency:** Encourages the temporal structure of the music to match the rhythm and cadence implied by the input caption.
- **ðŸŽµ Harmonic Consistency:** Penalizes musically inconsistent notes (e.g. out-of-key or dissonant phrases) to maintain tonal coherence.

By integrating these alignment-based rewards directly into the generation loop, Text2midi-InferAlign produces music that is not only more faithful to the prompt, but also more musically coherent.

We implement and evaluate our method on **Text2midi**, a state-of-the-art text-to-midi generation model, and demonstrate clear improvements in both **objective metrics** and **human evaluations**.

---

## ðŸ“Š Results

### âœ… Objective Evaluation

We evaluate performance on the MidiCaps dataset using six objective metrics. Our method outperforms the baseline on most alignment and structural consistency measures.

| Metric                  | Text2Midi | Text2midi-InferAlign |
|------------------------|-----------|-----------------------|
| **CR** (Compression Ratio) â†‘         | 2.16      | **2.31**              |
| **CLAP** (Text-Audio Consistency) â†‘  | 0.17      | **0.22**              |
| **TB** (Tempo Bin %) â†‘               | 29.73     | 35.41                 |
| **TBT** (Tempo Bin w/ Tolerance %) â†‘ | 60.06     | 62.59                 |
| **CK** (Correct Key %) â†‘             | 13.59     | **29.80**             |
| **CKD** (Correct Key w/ Duplicates %) â†‘ | 16.66  | **32.54**             |

**Note:** All results are averaged over about **50%** randomly selected captions from the MidiCaps test set (7913 examples).

---

### ðŸŽ§ Subjective Evaluation

We conducted a user study with 24 participants. Participants were asked to compare music generated by **Text2Midi** and **Text2midi-InferAlign**, evaluating based on musical quality and text-audio alignment.

#### Music Quality & Text-Audio Match

| Evaluation Criteria   | Text2Midi (%) | Text2midi-InferAlign (%) |
|-----------------------|---------------|---------------------------|
| Music Quality         | 31.25         | **68.75**                 |
| Text-Audio Match      | 41.67         | **58.33**                 |

#### Caption Type Preference

| Caption Type         | Text2Midi (%) | Text2midi-InferAlign (%) |
|----------------------|---------------|---------------------------|
| MidiCaps Caption     | 48.33         | **51.67**                 |
| Free Text Caption    | 27.78         | **72.22**                 |

These results demonstrate that **Text2midi-InferAlign** not only improves alignment and tonal structure, but also generalizes better to open-ended prompts.

---
